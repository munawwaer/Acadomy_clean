version: '3.8'

services:
  # 1. Ù‚Ø§Ø¹Ø¯Ø© Ø§Ù„Ø¨ÙŠØ§Ù†Ø§Øª (ÙƒÙ…Ø§ Ù‡ÙŠ)
  db:
    image: postgres:15
    volumes:
      - postgres_data:/var/lib/postgresql/data
    restart: always  
    environment:
      - POSTGRES_DB=launchpad_db
      - POSTGRES_USER=admin
      - POSTGRES_PASSWORD=adminpass
  pgadmin:
    image: dpage/pgadmin4
    environment:
      - PGADMIN_DEFAULT_EMAIL=admin@gmail.com
      - PGADMIN_DEFAULT_PASSWORD=root
    ports:
      - "5050:80"
    depends_on:
      - db    
  # 2. Ø§Ù„Ø¨Ø§Ùƒ Ø§Ù†Ø¯ (Django)
  backend:
    build: ./backend  # ğŸ‘ˆ ØºÙŠØ±Ù†Ø§ Ø§Ù„Ù…Ø³Ø§Ø± Ù„Ø£Ù†Ù†Ø§ Ù†Ù‚Ù„Ù†Ø§ Ø§Ù„Ù…Ù„ÙØ§Øª
    command: python manage.py runserver 0.0.0.0:8000
    volumes:
      - ./backend:/app
    ports:
      - "8000:8000"
    depends_on:
      - db
    environment:
      - DB_NAME=launchpad_db
      - DB_USER=admin
      - DB_PASSWORD=adminpass
      - DB_HOST=db

  # 3. Ø§Ù„ÙØ±ÙˆÙ†Øª Ø§Ù†Ø¯ (React) - Ø§Ù„Ø¥Ø¶Ø§ÙØ© Ø§Ù„Ø¬Ø¯ÙŠØ¯Ø© ğŸ”¥
  frontend:
    build: ./frontend     # ÙŠØ¨Ù†ÙŠ Ù…Ù† Ù…Ø¬Ù„Ø¯ Ø§Ù„ÙØ±ÙˆÙ†Øª Ø§Ù†Ø¯
    volumes:
      - ./frontend:/app   # ğŸ‘ˆ Ù…ÙŠØ²Ø© Hot Reload (ØªØ¹Ø¯Ù„ Ø§Ù„ÙƒÙˆØ¯ ÙŠØªØ­Ø¯Ø« Ø§Ù„Ù…ØªØµÙØ­ ÙÙˆØ±Ø§Ù‹)
      - /app/node_modules # Ø­Ù…Ø§ÙŠØ© Ù…Ø¬Ù„Ø¯ Ø§Ù„Ù…ÙƒØªØ¨Ø§Øª Ù…Ù† Ø§Ù„Ù…Ø³Ø­
    ports:
      - "5173:5173"       # Ù†ÙØªØ­ Ø¨ÙˆØ±Øª Ø±ÙŠØ§ÙƒØª
    environment:
      - CHOKIDAR_USEPOLLING=true
      # Ù†Ø­Ø¯Ø¯ Ø±Ø§Ø¨Ø· Ø§Ù„Ø¨Ø§Ùƒ Ø§Ù†Ø¯
      - REACT_APP_API_URL=http://localhost:8000 
    stdin_open: true      # Ø¶Ø±ÙˆØ±ÙŠ Ø¬Ø¯Ø§Ù‹ Ø¹Ø´Ø§Ù† Ø±ÙŠØ§ÙƒØª Ù…Ø§ ÙŠØºÙ„Ù‚ ÙÙˆØ±Ø§Ù‹
    tty: true

volumes:
  postgres_data:
